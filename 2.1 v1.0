2.1 OLT可靠性设计模式
主备（active-standby）冗余模式（也称为2N冗余，1+1冗余），指由一个服务实例（Service Instance）由一主一备两个服务单元（Service Unit）组成，两个服务单元是相同的软件，分别运行在不同节点（Node）中，节点根据故障保护范围的不同，可以是虚拟机、单板、机框等；一般情况下，主备服务单元需要至少跨物理硬件部署，以确保硬件故障时服务的继续提供，否则就失去了硬件冗余功能，仅存在了软件冗余功能，即当主服务单元的软件发生错误的时候，能够切换到备用服务单元的软件。
1、初始部署完成后，主备服务单元之间的配置数据、状态数据周期或者有变化时触发同步，同步方式采取点对点消息同步，同步双写等方式。
2、根据备份数据范围不同，可以分为如下几个场景：
①冷备份：仅备份软件包、配置数据、日志等操作维护类数据；备生主后通过系统复位重新加载软件包和配置数据，故障业务中断一般为分钟级；
②温备份：除了操作维护类数据，还需要备份状态数据；备生主后系统不复位，状态快速恢复。故障业务中断一般为秒级；
③热备份：将用户空间上下文，系统空间上下文，寄存器上下文形成系统快照并备份到备节点；备生主后基于内存快照快速恢复故障节点状态；故障可以做到业务0中断的效果；
在同一时间只有主服务单元对外提供完整服务，备服务单元处于待命状态，当主服务实例失效时，备服务实例能够快速切换成主服务实例继续提供服务以减少系统的故障时间。
在数据存储领域，数据冗余会出现多副本，相当于一主多备，一主多备参考N+M冗余设计模式；
发生倒换的条件：
1、Node故障触发主备倒换：
1、Node#A故障，Node#B上的Service Unit#2被重新仲裁成主用服务单元对外提供服务。
2、HA服务检测服务单元的状态，常见的检测方法有：
①P层心跳；
②I层故障快速通知，常见于嵌入式设备软硬件一体化集成场景（如BBU，RNC等）和分层云厂家垂直集成场景（如我司E9000+FusionShpere+MANO+VNF）
3、服务单元的主备倒换过程对服务消费者不可见， 服务实例通过逻辑标识提供对外的服务访问，倒换过程逻辑标识不变。
2、组件故障发生倒换
1、Service Unit #1中的关键组件C1故障，且无法通过重启等手段恢复，则会导致整个服务单元无法提供服务，Node#B上的Service Unit#2被重新仲裁成主用服务单元对外提供服务。
2、关键组件的异常由服务单元自身检测，或者由服务消费者通过服务体验的角度检测，并通知HA服务，触发重新仲裁；
冗余可信属性
该设计模式支撑无单点故障可信设计原则，通过1+1主备的部署设计，可以在主用单元单点故障场景下，备用单元升主提供服务 ，保障服务的连续性。
针对此模式系统自身的可信，需要考虑如下设计要点：
1、	要支持脑裂检测和后处理：要具备软硬件仲裁错误（双主或双备）的检测和恢复能力。
2、	备份不完全可靠，需要有恢复手段：所有备份内容都存在丢失的可能，重要信息需要考虑上下层核查、主备核查、主备双发或周期备份方式。
3、	故障突发备份需要流控：避免故障突发导致大量的备份申请，使CPU过载，对故障导致的异常释放需要进行流控；
4、	主备倒换稳态异常需要支持检测和后处理：主备倒换后，如果发生业务异常，需要支持自愈处理，包括同时复位主备进程，复位整系统等方式恢复，自愈次数建议限制，不能频繁自愈；
原理描述：
OLT中转发模块需要两块主控板，即交换芯片，板级主备，单板上的软件的主备状态跟随单板级的主备状态。当主用单板检测到关键软硬件故障时，单板状态切换为备用状态，同时备用单板切换为主用状态，原主用单板建立的业务中断，基站业务自动恢复，提升基站可靠性。
主备竞争：
当上电启动时，如果两块单板的状态都正常，则两块主控板通过主备竞争决定主用单板，此过程由HA service服务自动完成。
数据备份：
主备主控板之间不需要实时同步数据，仅需保证主备主控板间的静态数据（配置数据、软件、日志等）同步，备用单板不备份主用单板上的信令和业务数据。数据备份的过程根据发起的时机不同，分为两个阶段：
初始备份：基站启动完成，主备单板启动完成后，主备主控传输板间比较文件差异。以主用单板为基准，采用FTP方式同步所有差异文件到备用单板，并删除备用单板上的多余文件。同步的文件包括：配置数据、软件、日志等。
日常备份：基站初始备份结束后，在系统正常运行过程中，主备单板间周期性（5分钟）比较文件差异。本过程以主用单板为基准，采用FTP方式同步所有差异文件到备用单板。
主备倒换
主备倒换的触发因素包括两种：
故障触发：当主用单板出现关键器件故障、运行异常或单板文件系统损坏时，系统自动触发倒换。
人工触发：用户下发MML命令触发主备倒换。
