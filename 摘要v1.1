随着企业新兴业务推动宽带需求的急剧增长，光线路终端（Optical Line Terminal，OLT）在网络业务处理、接口适配与保护、业务信号的汇聚等方面起着越来越重要的作用。然而，由于当前的接入网络业务的多样性和网络资源的复杂性，要增强高速接入网OLT的安全性和可靠性，保证下层业务的实时同步仍具有很大的挑战性。同时，企业新兴业务升级引发带宽需求膨胀式增长，对汇聚网络带宽的稳定性及业务资源的高效处理方面提出了更高的要求。因此，为了保证接入网的安全性和可靠性上对OLT中的表项调度系统进行研究具有重要的工程应用价值。
本文在分析并学习了通信网络中接入网理论知识的基础上，深入研究了接入网中OLT设备的主备倒换机制及表项调度方式，主要研究工作如下：
（1）在对当前OLT表项调度系统中的主备倒换机制、802.1协议和TR-101协议进行对比分析的基础上，通过对企业接入网组网需求进行分析，结合实际项目对OLT表项调度系统进行了系统搭建。该系统由表项同步模块，表项转发模块构成，并确定了每个模块的具体业务流程。
（2）在表项同步模块，针对大量MAC表项变化的场景，表项同步机制耗时过长，通过实际测量，在linux下，发送一条消息耗时约为4ms，因此在出现N条表项变化时，其发送数据流传输（Reliable Datagram Protocol ,RDP）消息就需耗时N*4 ms，导致同步时间过长的问题，主要瓶颈在于RDP消息。本文提出了中断和3秒查询相结合的方案，修改原有RDP传输机制，提高发送效率，产生先进先出的数据缓存(First In First Out,FIFO)从而进行直接内存访问（Direct Memory Access，DMA）中断，处理表项变化，通过RDP将对应消息传递到备板，进行单播，组播，广播报文转发。实验结果表明，该方案实现了主备板的实时同步，解决了当OLT出现故障时，对上层业务造成时延过大的问题。
（3）在表项转发模块，针对传统接入设备中，用户报文的转发是基于MAC地址学习机制来进行，该机制存在用户伪造报文内容影响设备转发处理的问题。本文提出了一种基于S+C(S-VLAN+C-VLAN，S+C)特性来进行报文的转发方案。
该方案关闭VLAN的MAC地址学习，采用S-VLAN+C-VLAN转发。实验结果表明，该方案实现了报文的转发，解决了MAC地址空间不够和使用VLAN+ MAC转发时的安全问题。
（4）通过接入网平台对本文提出的OLT表项调度系统进行验证，结果表明在OLT中应用上述方案可以使当OLT主板发生故障时，主备板表项可以实时同步，并解决了MAC地址欺骗的问题，提升了高速接入网的安全性和可靠性。


 
第2章 表项调度系统分析与架构
 本章将主要对OLT表项调度系统进行需求分析与系统架构设计。首先对当前系统的表项同步方案、表项转发方案进行对比分析，对目前企业接入网络解决方案的需求进行分析，根据网络需求对OLT表项调度系统进行改进方案的系统架构。在下一章中将针对改进方案进行详细设计，对具体设计内容进行详细讨论。
2.1 系统分析
	本节将对OLT表项调度系统进行系统分析，主要对当前接入网的OLT设备的架构进行分析，了解OLT的芯片类型以及选择本论文进行研究的OLT设备。对当前OLT系统中主流的表项同步方案以及表项转发方案进行了对比分析，下面将详细讨论。
2.1.1交换芯片业务功能分析
	交换芯片具有强大功能。近年来许多中高端的商用交换芯片能够提供多个
速率端口,支持二层和三层交换功能,具有齐全的包过滤和流控功能,支持双层
和多个优先级分类功能等,芯片还支持堆叠和扩展,标准的等接口让芯片更易于
管理。交换芯片的强大功能决定了交换芯片在系统中的重要作用,控制好交换芯片能够找到优化业务的可行方案，提高OLT的安全性。
交换芯片架构图

2.1.2 交换芯片表项分析
交换芯片的二层转发功能基于芯片的二层表（L2_ENTRY）。芯片中二层转发表项分为四种，VLAN-based bridging、Single-VLAN、Double-VLAN、Virtual Forwarding Instance。这四类其中只有VLAN-based bridging和Virtual Forwarding Instance（VPLS/ MPLS/ PBB/ MIM）可以自学习，而四种表项都可以老化。
芯片提供的二层表项为32K，被分为4K的bucket每个bucket有8个entry。如果dual hashing可用的话二层表项可以被化分为两个逻辑表，每个逻辑表有4K的bucket每个bucket包含四个entry。二层表项学习模式有多种（CML），可以通过每个端口的port table进行配置。
入口根据MAC_SA查找二层表项如果没有在二层表项中没有查找到则根据CML_FLAGS_NEW来处理MAC地址的学习情况，如果查找到了但表项中的端口信息与入口信息不符者根据CML_FLAGS_MOVE来处理MAC地址的学习。
能引发MAC地址学习操作的情况有三种：SA未查找到l2_entry有剩余空间、SA未查找到l2_entry没有剩余空间、SA查找到但找到的表项中的模块ID和port id的信息与入口包不相同。
如果使用软件学习的模式可以设置Pending 和 Copy to CPU：Pending模式是硬件学习MAC地址，但学习到后表项设置为Pending，这种模式下将首包送到CPU，并将此信息记录在L2_MOD_FIFO表中，后续报文在查表时会发现MAC地址项并且是Peding就不再将报文送到CPU了。CPU在收到报文后分析报文信息使用L2_INSTER此表项就真正的学习完成。如果设置了Pending但没有设置Copy to CPU，cpu可以从L2_MOD_FIFO表中获取信息来进行MAC地址的学习
2.2表项调度系统需求分析

2.3表项调度系统总体设计及搭建


 
第3章 OLT表项调度系统方案改进
  本章开始将对上一章中设计的系统模块进行具体的模块化设计，针对当前OLT中表项调度系统中主备倒换机制的时延过长，易产生未知单播的问题对系统中的主备倒换方案进行改进；针对系统中现有MAC地址转发机制存在的MAC地址欺骗的问题，对系统的表项转发方案进行改进，从而来提高OLT的安全性。
3.1 典型的表项调度方案
3.2表项同步方案改进
3.3表项转发方案改进


 
第4章 测试与结果分析
	本章将对上一章提出的OLT表项调度系统中改进的表项同步方案和改进的数据处理方案进行实验验证。根据改进方案的需求设计测试环境并进行搭建，设计测试用例来验证OLT的可靠性和安全性，并对实验结果进行对比分析。
